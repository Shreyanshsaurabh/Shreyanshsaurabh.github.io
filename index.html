<!DOCTYPE html>

<html lang="en">
    <head>
        <title>Sudoko</title>
        <link rel="stylesheet" href="sudoku.css">
<script>
</script>
</head>
<body>
<div class="upper">
    <img src="logo.png" alt="Logo" class="logo">
    <img src="title.png" alt="Logo" class="title">
</div>

<table id="sudoku"></table>

  <script>
    const puzzles = [
      {
        puzzle: [
          [5, 3, '', '', 7, '', '', '', ''],
          [6, '', '', 1, 9, 5, '', '', ''],
          ['', 9, 8, '', '', '', '', 6, ''],
          [8, '', '', '', 6, '', '', '', 3],
          [4, '', '', 8, '', 3, '', '', 1],
          [7, '', '', '', 2, '', '', '', 6],
          ['', 6, '', '', '', '', 2, 8, ''],
          ['', '', '', 4, 1, 9, '', '', 5],
          ['', '', '', '', 8, '', '', 7, 9]
        ]
      },
      {
        puzzle: [
          ['', '', '', 2, 6, '', 7, '', 1],
          [6, 8, '', '', 7, '', '', 9, ''],
          [1, 9, '', '', '', 4, 5, '', ''],
          [8, 2, '', 1, '', '', '', 4, ''],
          ['', '', 4, 6, '', 2, 9, '', ''],
          ['', 5, '', '', '', 3, '', 2, 8],
          ['', '', 9, 3, '', '', '', 7, 4],
          ['', 4, '', '', 5, '', '', 3, 6],
          [7, '', 3, '', 1, 8, '', '', '']
        ]
      }
    ];

    let original = [];
    const size = 9;

    function createBoard(puzzle) {
      const table = document.getElementById("sudoku");
      table.innerHTML = "";
      original = JSON.parse(JSON.stringify(puzzle)); // deep copy

      for (let i = 0; i < size; i++) {
        const row = document.createElement("tr");
        for (let j = 0; j < size; j++) {
          const cell = document.createElement("td");

          // Add bold border for 3x3 subgrids
          if (j % 3 === 0) cell.style.borderLeft = "2px solid black";
          if (i % 3 === 0) cell.style.borderTop = "2px solid black";

          const input = document.createElement("input");
          input.setAttribute("maxlength", "1");

          if (puzzle[i][j] !== '') {
            input.value = puzzle[i][j];
            input.disabled = true;
          } else {
            input.addEventListener("input", function () {
              if (!/^[1-9]$/.test(input.value)) input.value = '';
            });
          }

          cell.appendChild(input);
          row.appendChild(cell);
        }
        table.appendChild(row);
      }
    }

    function getCurrentBoard() {
      const board = [];
      const rows = document.querySelectorAll("#sudoku tr");
      rows.forEach(row => {
        const cells = row.querySelectorAll("input");
        const rowData = [];
        cells.forEach(cell => {
          rowData.push(cell.value === '' ? '' : parseInt(cell.value));
        });
        board.push(rowData);
      });
      return board;
    }

    function checkSolution() {
      const board = getCurrentBoard();

      const isValid = (board) => {
        const rows = Array.from({ length: size }, () => new Set());
        const cols = Array.from({ length: size }, () => new Set());
        const boxes = Array.from({ length: size }, () => new Set());

        for (let i = 0; i < size; i++) {
          for (let j = 0; j < size; j++) {
            const val = board[i][j];
            if (val === '') return false;

            const boxIndex = Math.floor(i / 3) * 3 + Math.floor(j / 3);

            if (rows[i].has(val) || cols[j].has(val) || boxes[boxIndex].has(val)) {
              return false;
            }
            rows[i].add(val);
            cols[j].add(val);
            boxes[boxIndex].add(val);
          }
        }
        return true;
      };

      alert(isValid(board) ? "✅ Correct solution!" : "❌ Incorrect. Try again.");
    }

    function resetBoard() {
      const inputs = document.querySelectorAll("#sudoku input");
      inputs.forEach((input, index) => {
        const row = Math.floor(index / size);
        const col = index % size;
        if (!input.disabled) {
          input.value = original[row][col] || '';
        }
      });
    }

    function newGame() {
      const puzzle = puzzles[Math.floor(Math.random() * puzzles.length)].puzzle;
      createBoard(puzzle);
    }

    // Load initial puzzle
    window.onload = newGame;
  </script>
</div>
<div class="controls" id="controls">
    <button onclick="newGame()">New Game</button>
    <button onclick="checkSolution()">Check Solution</button>
    <button onclick="resetBoard()">Reset</button>
  </div>
</body>
</html>
